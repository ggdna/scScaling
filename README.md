# scScaling

This repository provides code to reproduce the results from *Measurement noise scaling laws for cellular representation learning* (under review).

## Requirements

To install requirements:

`pip install -r requirements.txt`

Some datasets (to reproduce spatial and clonal information results) must be downloaded separately. Instructions below:

1. **Downloading Vizgen mouse brain data release.** Download [MERFISH mouse brain atlas](https://info.vizgen.com/mouse-brain-data`), and save in `/data/`.

2. **Downloading hematopoiesis LT-Seq data.** Download all files from Experiment 1 from the [Weinreb et al., 2020 data repository](https://github.com/AllonKleinLab/paper-data/tree/master/Lineage_tracing_on_transcriptional_landscapes_links_state_to_fate_during_differentiation). Save them in `data/`.

## Preprocessing and count downsampling

All single cell data can be preprocessed and downsampled by running the `/data/preprocessing/*_downsampling.ipynb` scripts.

## Embeddings

All embeddings can be generated by running the `/embeddings/*_driver.ipynb` notebooks. These call the scripts `/embeddings/*embedding_generation.py` with the parameters used for the paper.

## Results

For single cell data, MI estimates are made in the `/analysis/*_MI_estimation.ipynb` and saved in the results folder as .csv. 

For imaging data, preprocessing, model training, and MI estimation takes place in single notebooks for each experimental setting. See `/analysis/Caltech101*.ipynb` notebooks.

These encompass the main empirical results of the paper. The remaining notebooks in the `/analysis/` folder are for generating Appendix results, and for curve fitting. The notebooks in the `/results/` folder generate "pretty plots" for the paper.

## Additional info

This is, to the best of my knowledge, all the material necessary to reproduce results in our paper. If you run into issues or need more information, feel free to reach out :)